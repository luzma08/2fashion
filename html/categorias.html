<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categoria mujer</title>
    <link rel="stylesheet" href="../css/categorias.css">
    <link rel="shortcut icon" href="../img/icono-2-fashion.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<<<<<<< HEAD
   <header class="header">
    <div class="logo">
        <a href="./landing.page.html"><img src="../img/logo.svg" alt="Logo"></a>
    </div>

    <div class="additional-logos">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input type="search" id="buscador" placeholder="Buscar ropa...">
        
        <i class="fa-solid fa-circle-info"></i>
    </div>
    
    <input type="checkbox" id="toggle">
    <label for="toggle"></label>
    
      
    <nav class="navegacion">
        <ul>
            <li><a href="./landing.page.html">Inicio</a></li>
            <li><a href="./sobrenostros.html">Sobre nosotras</a></li>
            <li>
                <a href="#">Categorías</a>
                <ul>
                    <li><a href="./categorias.html">Mujeres</a></li>
                    <li><a href="./categoria-hombre.html">Hombres</a></li>
                    <li><a href="./categoria-niños.html">Niños</a></li>
                </ul>
            </li>
        </ul>
    </nav>


    <div class="iconos">
        <a href="./favoritos.html" class="icono-con-contador">
          <span class="contador" id="contador-fav">0</span>
          <i class="fa-solid fa-heart"></i>
        </a> 
        <a onclick="llevaracarrito()" class="icono-con-contador">
          <span class="contador" id="contador-carrito">0</span>
          <i class="fa-solid fa-cart-shopping"></i>
        </a>
        <a href="./infousuario.html"><i class="fa-solid fa-user"></i></a>
      </div>
</header>

=======
    <header class="header">
        <div class="logo">
            <a href="../index.html"><img src="../img/logo.svg" alt="Logo"></a>
        </div>
        <div class="additional-logos">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input type="search" id="buscador" placeholder="Buscar ropa...">
            <i class="fa-solid fa-circle-info"></i>
        </div>
        <input type="checkbox" id="toggle">
        <label for="toggle"></label>
        <nav class="navegacion">
            <ul>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="sobrenostros.html">Sobre nosotras</a></li>
                <li>
                    <a href="categorias.html">Categorías</a>
                    <ul>
                        <li><a href="categorias.html">Mujeres</a></li>
                        <li><a href="categoria-hombre.html">Hombres</a></li>
                        <li><a href="categoria-niños.html">Niños</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div class="iconos">
            <a href="favoritos.html" class="icono-con-contador">
              <span class="contador" id="contador-fav">0</span>
              <i class="fa-solid fa-heart"></i>
            </a> 
            <a onclick="llevaracarrito()" class="icono-con-contador">
              <span class="contador" id="contador-carrito">0</span>
              <i class="fa-solid fa-cart-shopping"></i>
            </a>
            <a href="infousuario.html"><i class="fa-solid fa-user"></i></a>
        </div>
    </header>
>>>>>>> e870d6c (Subo mis archivos actualizados)
    
    <div class="ropa">
        <a href="javascript:void(0);" style="color: purple;" class="filtros" onclick="eliminarChulito()">Eliminar filtros</a>
        <h3 class="titulo-ropa">Palabras clave</h3>
        <button class="primavera">Primavera</button>     <button class="moderno">Moderno</button>
        <form id="lista-ropa">
            <label id="escoger-ropa"><input type="checkbox" class="miCheckbox" name="ropa" id="ropa1">Blusa</label>
            <br>
            <label id="escoger-ropa"><input type="checkbox" class="miCheckbox" name="ropa" id="ropa2">Faldas</label>
            <br>
            <label id="escoger-ropa"><input type="checkbox" class="miCheckbox" name="ropa" id="ropa3">Sueteres</label>
            <br>
            <label id="escoger-ropa"><input type="checkbox" class="miCheckbox" name="ropa" id="ropa4">Pantalones</label>
            <br>
            <label id="escoger-ropa"><input type="checkbox" class="miCheckbox" name="ropa" id="ropa5">Shorts</label>
        </form>
        <h4 class="titulo-ropa">Color</h4>
        <form id="colores">
            <label id="escoger-color"><input type="checkbox" class="miCheckbox" name="color" id="color1">Negro</label>
            <br>
            <label id="escoger-color"><input type="checkbox" class="miCheckbox" name="color" id="color2">Gris</label>
            <br>
            <label id="escoger-color"><input type="checkbox" class="miCheckbox" name="color" id="color3">Blanco</label>
            <br>
            <label id="escoger-color"><input type="checkbox" class="miCheckbox" name="color" id="color4">Azul</label>
        </form>
        <h4 class="titulo-ropa">Tallas</h4>
        <form id="tallas">
            <label id="escoger-tallas"><input type="radio" class="miCheckbox" name="talla" id="talla1">S</label>
            <br>
            <label id="escoger-tallas"><input type="radio" class="miCheckbox" name="talla" id="talla2">M</label>
            <br>
            <label id="escoger-tallas"><input type="radio" class="miCheckbox" name="talla" id="talla3">L</label>
            <br>
            <label id="escoger-tallas"><input type="radio" class="miCheckbox" name="talla" id="talla4">XL</label>
        </form>
        <div class="rango-precios">
            <label for="precio">Rango de precios:</label><br>
            <input type="range" id="precio" name="precio" min="13000" max="100000" step="100" value="13000" oninput="actualizarValor()">
            <div class="valores-rango">
                <span id="valorActual">13.000</span>
            </div>
        </div>
        <button id="aplicar-filtros">Aplicar filtros</button>
    </div>

    <section id="Mostradores">
        <div id="productos-container"></div>
    </section>

<<<<<<< HEAD
<!--Cuadros para poner las prendas de ropa -->
<section id="Mostradores">
    <div class="fila">
        <div class="recuadro-ropa">
            <div class="cuadroderopa">
                <a href="./detalles_blusa_tirantes.html" target="_blank"> 
                    <div class="img-categorias"> <img src="../img/blusa-de-tirantes.jpg" alt="">
                </div>
            </div>
            <div class="texto-info">
                <h4>Blusa de tirantes</h4>
                <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
              </div>              
            <a href="#"><i id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
            <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
            <div class="texto-precio"><h3>$15.000</h3></div>
        </div>
        <div class="recuadro-ropa">
            <div class="cuadroderopa"> 
                <a href="./detalles_pantalon.html" target="_blank"> 
                    <div class="img-categorias"> <img src="../img/pantalon-deportivo.jpg" alt=""></div>
            </div>
            <div class="texto-info"><h4>Pantalón deportivo</h4>
                <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
            </div>
            <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
            <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
            <div class="texto-precio"><h3>$31.000</h3></div>
        </div>
        <div class="recuadro-ropa">
            <div class="cuadroderopa"> 
                <a href="./detalles.html" target="_blank"> 
                    <div class="img-categorias"> <img src="../img/sueter.jpg" alt=""></div>
            </div>
            <div class="texto-info"><h4>Suéter</h4>
                <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
            </div>
            <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
            <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
            <div class="texto-precio"><h3>$13.000</h3></div>
        </div>
        <div class="recuadro-ropa">
            <div class="cuadroderopa"> 
                <a href="./detalles_body.html" target="_blank"> 
                    <div class="img-categorias"> <img src="../img/body.jpg" alt=""></div>
            </div>
            <div class="texto-info"><h4>Body acanalado</h4>
                <p class="talla-compra">Talla: S</p> <!-- Esta es la nueva línea -->
            </div>
            <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
            <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
            <div class="texto-precio"><h3>$20.000</h3></div>
        </div>
    </div>
    <div class="fila">
        <div class="recuadro-ropa">
            <div class="cuadroderopa"> 
                <a href="./detalles_chaleco.html" target="_blank"> 
                    <div class="img-categorias"> <img src="../img/chaleco.jpg" alt=""></div>
            </div>
        <div class="texto-info"><h4>Chaleco de tela</h4>
            <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
        </div>
        <a href="#"><i id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
        <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
        <div class="texto-precio"><h3>$20.000</h3></div>
    </div>
    <div class="recuadro-ropa">
        <div class="cuadroderopa"> 
            <a href="./detalles_falda_tubo.html" target="_blank"> 
                <div class="img-categorias"> <img src="../img/falda-tubo.jpg" alt=""></div>
        </div>
        <div class="texto-info"><h4>Falda de tubo</h4>
            <p class="talla-compra">Talla: L</p> <!-- Esta es la nueva línea -->
        </div>
        <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
        <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
        <div class="texto-precio"><h3>$30.000</h3></div>
    </div>
    <div class="recuadro-ropa">
        <div class="cuadroderopa"> 
            <a href="./detallles_short.html" target="_blank">
                 <div class="img-categorias"> <img src="../img/shor-jean.jpg" alt=""></div>
        </div>
        <div class="texto-info"><h4>Short de Mezclilla</h4>
            <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
        </div>
        <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
        <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
        <div class="texto-precio"><h3>$28.000</h3></div>
    </div>
    <div class="recuadro-ropa">
        <div class="cuadroderopa"> 
            <a href="./detalles_falda_cargo.html" target="_blank"> 
                <div class="img-categorias"> <img src="../img/falda-cargo.jpg" alt=""></div>
        </div>
        <div class="texto-info"><h4>Falda cargo corta</h4>
            <p class="talla-compra">Talla: M</p> <!-- Esta es la nueva línea -->
        </div>
        <a href="#"><i  id="icono-compra" class="fa-solid fa-cart-shopping"></i></a>
        <a href="#"><i id="icono-corazon" class="fa-solid fa-heart"></i></a> 
        <div class="texto-precio"><h3>$30.000</h3></div>
    </div>
    </div>
</section>
<footer class="footer">
    <div class="footer-content">
        <h1>2fashion</h1>
        <div class="conctact">
            <div class="title">Conctacto</div>
            <li class="lista">
                <ul class="elem">
                    2fashion
                </ul>
                <ul class="elem">
                    3155131227
                </ul>
                <ul class="elem">
                    devprogramm4.@gmail.com
                </ul>
            </li>
        </div>
        <div class="direction">
            <div class="title">Legal</div>
            <li class="lista">
                <ul class="elem">
                  <a href="../html/terminosycondiciones.html">Terminos y condiciones </a>  
    
                </ul>
                    <ul class="elem">
                    <a href="../html/poliricadeprivacidad.html">Política de pricivacidad y cookies</a> 
                </ul>
            </li>
        </div>
        <div class="services">
            <div class="title">Menu</div>
            <li class="lista">
                <ul class="elem">
                    <a href="./landing.page.html">Inicio</a> 
                </ul>
                <ul class="elem">
                    <a href="../html/sobrenostros.html">Sobre nosotros</a> 
                </ul>
                <ul class="elem">
                    <a href="../html/categorias.html">Categoria mujeres</a> 
                </ul>
                <ul class="elem">
                    <a href="../html/categoria-hombre.html">Categoria hombre</a> 
                </ul>
                <ul class="elem">
                    <a href="../html/categorias.html">Categoria niños</a> 
                </ul>
                <ul class="elem">
                  Personalizar ropa
                </ul>
            </li>
        </div>
        <div class="social">
            <div class="title">Conctacto</div>
            <div class="social-content">
                <a class="elem">
                    <i class="fa-brands fa-instagram"></i>
                </a>
                <a class="elem">
                    <i class="fa-brands fa-facebook"></i>
                </a>
                <a class="elem">
                    <i class="fa-brands fa-whatsapp"></i>
                </a>
            </div>
        </div>
    </div>
     </footer>
<div id="mensaje-carrito" style="font-family: Poppins, serif;  position: fixed; top: 20px; right: 20px; background-color: #53214F; color: white; padding: 10px 20px; border-radius: 10px; z-index: 9999;"></div>


<script src="../js/categorias.js"></script>
=======
    <a href="#" id="mostrar-mas">Mostrar más</a>

    <div id="mensaje-carrito" style="font-family: Poppins, serif;  position: fixed; top: 20px; right: 20px; background-color: #53214F; color: white; padding: 10px 20px; border-radius: 10px; z-index: 9999;"></div>
    <div id="mensaje-favoritos" style="font-family: Poppins, serif; position: fixed; top: 20px; right: 20px; background-color: #53214F; color: white; padding: 10px 20px; border-radius: 10px; z-index: 9999; display: none;"></div>
>>>>>>> e870d6c (Subo mis archivos actualizados)

<script>
// Configuración de Supabase
const SUPABASE_URL = 'https://hxrcmbaxxfvlgubpdifu.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh4cmNtYmF4eGZ2bGd1YnBkaWZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI0OTgxNzQsImV4cCI6MjA1ODA3NDE3NH0.uPrLyN5PfPv8kx414tZetdQLkiQGXq9Lkg_kJZ1zvyc';
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let todosLosProductos = [];
let productosFiltrados = [];
let productosMostrados = 8;
const incrementoProductos = 4;

const paginaActual = window.location.pathname;
let categoriaActual = 'mujer';
if (paginaActual.includes('categoria-hombre')) categoriaActual = 'hombre';
else if (paginaActual.includes('categoria-niños')) categoriaActual = 'niño';

async function cargarProductos() {
    try {
        const productosContainer = document.getElementById('productos-container');
        productosContainer.innerHTML = '<p class="cargando">Cargando productos...</p>';
        const { data, error } = await supabase
            .from('productos')
            .select('*')
            .eq('categoria', categoriaActual)
            .eq('vendido', false)
            .order('created_at', { ascending: false });
        if (error) throw error;
        todosLosProductos = data || [];
        productosFiltrados = [...todosLosProductos];
        productosMostrados = 8;
        mostrarProductos();
    } catch (error) {
        document.getElementById('productos-container').innerHTML =
            '<p class="error">Error al cargar los productos. Por favor, recarga la página.</p>';
    }
}

function mostrarProductos() {
    const productosContainer = document.getElementById('productos-container');
    productosContainer.innerHTML = '';
    if (!productosFiltrados || productosFiltrados.length === 0) {
        productosContainer.innerHTML = '<p class="no-productos">No hay productos disponibles con los filtros seleccionados.</p>';
        return;
    }
    const productosVisibles = productosFiltrados.slice(0, productosMostrados);
    const productosPorFila = 4;
    for (let i = 0; i < productosVisibles.length; i += productosPorFila) {
        const fila = document.createElement('div');
        fila.className = 'fila';
        for (let j = i; j < i + productosPorFila && j < productosVisibles.length; j++) {
            const producto = productosVisibles[j];
            const productoElement = crearProductoElement(producto);
            fila.appendChild(productoElement);
        }
        productosContainer.appendChild(fila);
    }
    const mostrarMasBtn = document.getElementById('mostrar-mas');
    if (productosMostrados >= productosFiltrados.length) {
        mostrarMasBtn.style.display = 'none';
    } else {
        mostrarMasBtn.style.display = 'block';
    }
    agregarEventListeners();
    actualizarContadores();
}

function crearProductoElement(producto) {
    const recuadro = document.createElement('div');
    recuadro.className = 'recuadro-ropa';
    recuadro.setAttribute('data-producto-id', producto.id);
    recuadro.innerHTML = `
        <div class="cuadroderopa">
            <a href="detalles_productos.html?id=${producto.id}"> 
                <div class="img-categorias"> 
                    <img src="${producto.imagen_url}" alt="${producto.nombre}">
                </div>
            </a>
        </div>
        <div class="texto-info">
            <h4>${producto.nombre}</h4>
            <p class="talla-compra">Talla: ${producto.talla}</p>
        </div>
        <a href="#" class="btn-carrito" data-id="${producto.id}">
            <i id="icono-compra" class="fa-solid fa-cart-shopping"></i>
        </a>
        <a href="#" class="btn-favorito" data-id="${producto.id}">
            <i id="icono-corazon" class="fa-solid fa-heart"></i>
        </a> 
        <div class="texto-precio"><h3>${formatearPrecio(producto.precio)}</h3></div>
    `;
    return recuadro;
}

function formatearPrecio(precio) {
    return '$' + Number(precio).toLocaleString('es-CO');
}

function agregarEventListeners() {
    document.querySelectorAll('.btn-carrito').forEach(boton => {
        boton.addEventListener('click', function(e) {
            e.preventDefault();
            const productoId = this.getAttribute('data-id');
            agregarAlCarrito(productoId);
        });
    });
    document.querySelectorAll('.btn-favorito').forEach(boton => {
        boton.addEventListener('click', function(e) {
            e.preventDefault();
            const productoId = this.getAttribute('data-id');
            agregarAFavoritos(productoId);
        });
    });
}

function agregarAlCarrito(productoId) {
    const producto = todosLosProductos.find(p => p.id == productoId);
    if (!producto) return;
    let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const productoEnCarrito = carrito.find(item => item.id == productoId);
    if (productoEnCarrito) {
        if (typeof productoEnCarrito.cantidad !== 'number' || isNaN(productoEnCarrito.cantidad)) {
            productoEnCarrito.cantidad = 1;
        } else {
            productoEnCarrito.cantidad += 1;
        }
    } else {
        carrito.push({
            id: producto.id,
            nombre: producto.nombre,
            precio: producto.precio,
            imagen_url: producto.imagen_url,
            talla: producto.talla,
            cantidad: 1
        });
    }
    localStorage.setItem('carrito', JSON.stringify(carrito));
    mostrarMensaje('carrito', `${producto.nombre} añadido al carrito`);
    actualizarContadores();
}

function agregarAFavoritos(productoId) {
    const producto = todosLosProductos.find(p => p.id == productoId);
    if (!producto) return;
    let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
    const productoEnFavoritos = favoritos.find(item => item.id == productoId);
    if (productoEnFavoritos) {
        favoritos = favoritos.filter(item => item.id != productoId);
        mostrarMensaje('favoritos', `${producto.nombre} eliminado de favoritos`);
    } else {
        favoritos.push({
            id: producto.id,
            nombre: producto.nombre,
            precio: producto.precio,
            imagen_url: producto.imagen_url,
            talla: producto.talla
        });
        mostrarMensaje('favoritos', `${producto.nombre} añadido a favoritos`);
    }
    localStorage.setItem('favoritos', JSON.stringify(favoritos));
    actualizarContadores();
}

function mostrarMensaje(tipo, mensaje, esError = false) {
    const elementoMensaje = document.getElementById(`mensaje-${tipo}`);
    elementoMensaje.textContent = mensaje;
    elementoMensaje.style.display = 'block';
    elementoMensaje.style.backgroundColor = esError ? '#d32f2f' : '#53214F';
    setTimeout(() => {
        elementoMensaje.style.display = 'none';
    }, 3000);
}

function actualizarContadores() {
    const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    let totalItemsCarrito = 0;
    carrito.forEach(item => {
        const cantidad = Number(item.cantidad);
        if (!isNaN(cantidad) && cantidad > 0) {
            totalItemsCarrito += cantidad;
        }
    });
    const favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
    document.getElementById('contador-carrito').textContent = totalItemsCarrito;
    document.getElementById('contador-fav').textContent = favoritos.length;
}

function aplicarFiltros(e) {
    if (e) e.preventDefault();

    let filtrados = [...todosLosProductos];

    // --- TIPO DE PRENDA (permite "Blusa", "Blusa manga larga", etc) ---
    const ropasSeleccionadas = Array.from(document.querySelectorAll('#lista-ropa input:checked'))
        .map(cb => cb.parentElement.textContent.trim().toLowerCase());
    if (ropasSeleccionadas.length > 0) {
        filtrados = filtrados.filter(producto => {
            const nombreLimpio = (producto.nombre || "").trim().toLowerCase();
            return ropasSeleccionadas.some(tipo => nombreLimpio.includes(tipo));
        });
    }

    // --- COLOR (en descripción) ---
    const coloresSeleccionados = Array.from(document.querySelectorAll('#colores input[name="color"]:checked'))
        .map(cb => cb.parentElement.textContent.trim());
    if (coloresSeleccionados.length > 0) {
        filtrados = filtrados.filter(producto =>
            coloresSeleccionados.some(color =>
                (producto.descripcion || '').toLowerCase().includes(color.toLowerCase())
            )
        );
    }

    // --- TALLA ---
    const tallaSeleccionada = document.querySelector('#tallas input[name="talla"]:checked')?.parentElement.textContent.trim();
    if (tallaSeleccionada) {
        filtrados = filtrados.filter(producto =>
            producto.talla === tallaSeleccionada
        );
    }

    // --- PRECIO ---
    const precioMaximo = parseInt(document.getElementById('precio').value, 10);
    filtrados = filtrados.filter(producto =>
        parseFloat(producto.precio) <= precioMaximo
    );

    productosFiltrados = filtrados;
    productosMostrados = 8;
    mostrarProductos();
}

function eliminarChulito() {
    document.querySelectorAll('.miCheckbox').forEach(cb => { cb.checked = false; });
    document.getElementById('precio').value = 13000;
    actualizarValor();
    productosFiltrados = [...todosLosProductos];
    productosMostrados = 8;
    mostrarProductos();
}

function actualizarValor() {
    const valor = document.getElementById('precio').value;
    document.getElementById('valorActual').textContent = `${parseInt(valor).toLocaleString('es-CO')}`;
}

function cargarMasProductos() {
    productosMostrados += incrementoProductos;
    mostrarProductos();
}

function llevaracarrito() {
    window.location.href = "/html/carrito.html";
}

document.addEventListener('DOMContentLoaded', () => {
    cargarProductos();
    document.getElementById('mostrar-mas').addEventListener('click', function(e) {
        e.preventDefault();
        cargarMasProductos();
    });
    document.getElementById('aplicar-filtros').addEventListener('click', function(e) {
        e.preventDefault();
        aplicarFiltros();
    });
    actualizarContadores();
    document.getElementById('precio').addEventListener('input', actualizarValor);
});
</script>
</body>
</html>